# vim: filetype=bash

alias ls="ls -Alh --color=auto"
alias grep="grep --color=auto"
alias run0="run0 --setenv=PS1"

export VISUAL='nvim'

user='\[\e[36m\]\u\[\e[0m\]'
hostname='\[\e[34m\]\h\[\e[0m\]'
working_dir='\[\e[32m\]\w\[\e[0m\]'
the_time='\[\e[33m\]\A\[\e[0m\]'
if [ "$TERM" = "dumb" ]; then
    export PS1="\$ "
else
    export PS1="$user at $hostname in $working_dir\n|-$the_time "
fi

if [[ "$INSIDE_EMACS" = 'vterm' ]] \
    && [[ -n ${EMACS_VTERM_PATH} ]] \
    && [[ -f ${EMACS_VTERM_PATH}/etc/emacs-vterm-bash.sh ]]; then
	source ${EMACS_VTERM_PATH}/etc/emacs-vterm-bash.sh
fi

if [ "$TERM" = "foot" ]; then
    osc7_cwd() {
        local strlen=${#PWD}
        local encoded=""
        local pos c o
        for (( pos=0; pos<strlen; pos++ )); do
            c=${PWD:$pos:1}
            case "$c" in
                [-/:_.!\'\(\)~[:alnum:]] ) o="${c}" ;;
                * ) printf -v o '%%%02X' "'${c}" ;;
            esac
            encoded+="${o}"
        done
        printf '\e]7;file://%s%s\e\\' "${HOSTNAME}" "${encoded}"
    }
    PROMPT_COMMAND=${PROMPT_COMMAND:+${PROMPT_COMMAND%;}; }osc7_cwd

    prompt_marker() {
        printf '\e]133;A\e\\'
    }
    PROMPT_COMMAND=${PROMPT_COMMAND:+$PROMPT_COMMAND; }prompt_marker
fi
